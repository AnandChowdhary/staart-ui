(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{231:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(83);var o=r(106);function c(e){return function(e){if(Array.isArray(e))return Object(n.a)(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(o.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},281:function(e,t,r){"use strict";r.r(t);r(15),r(16),r(10),r(37);var n=r(231),o=(r(31),r(8)),c=r(13),l=r(53),d=r(19),m=r(20),f=r(9),h=r(7),v=r(33);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(m.a)(this,r)}}var w=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},R=function(e){Object(d.a)(R,e);var t,r,m,f,h,v,w=y(R);function R(){var e;return Object(c.a)(this,R),(e=w.apply(this,arguments)).loading=!1,e.loadingAdd=!1,e.loadingId=0,e.team={},e.members={data:[]},e.userId="",e.newMemberName="",e.newMemberEmail="",e.newMemberRole="MEMBER",e}return Object(l.a)(R,[{key:"created",value:(v=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:try{this.userId=this.$store.state.auth.user.details.id}catch(e){}return e.abrupt("return",this.get());case 2:case"end":return e.stop()}}),e,this)}))),function(){return v.apply(this,arguments)})},{key:"updateRole",value:(h=Object(o.a)(regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingId=t,e.prev=1,e.next=4,this.$axios.patch("/groups/".concat(this.$route.params.id,"/memberships/").concat(t),{role:r});case 4:e.sent.data,e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),this.members.data=[],this.get();case 12:this.loadingId=0;case 13:case"end":return e.stop()}}),e,this,[[1,8]])}))),function(e,t){return h.apply(this,arguments)})},{key:"get",value:(f=Object(o.a)(regeneratorRuntime.mark((function e(){var t,r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.get("/groups/".concat(this.$route.params.id,"/memberships?take=10&include=user").concat(this.members.data.length?"&after=".concat(this.members.data[this.members.data.length-1].id):""));case 4:r=e.sent,data=r.data,(t=this.members.data).push.apply(t,Object(n.a)(data.data||[])),this.members.hasMore=data.hasMore,this.members=data,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(){return f.apply(this,arguments)})},{key:"add",value:(m=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingAdd=!0,e.prev=1,e.next=4,this.$axios.put("/groups/".concat(this.$route.params.id,"/memberships"),{name:this.newMemberName,email:this.newMemberEmail,role:this.newMemberRole});case 4:e.sent.data,this.get(),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:this.loadingAdd=!1;case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(){return m.apply(this,arguments)})},{key:"deleteMember",value:(r=Object(o.a)(regeneratorRuntime.mark((function e(t,r){var n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$buefy.dialog.confirm({title:"Removing member",message:"Are you sure you want to remove <strong>".concat(r,"</strong> from this team? This action is not reversible, and you'll have to add them again if you change your mind."),confirmText:"Yes, remove member",cancelText:"No, don't remove",type:"is-danger",hasIcon:!0,trapFocus:!0,onConfirm:function(){var e=Object(o.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.loading=!0,e.prev=1,e.next=4,n.$axios.delete("/groups/".concat(n.$route.params.id,"/memberships/").concat(t));case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",n.get());case 9:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"verifyMember",value:(t=Object(o.a)(regeneratorRuntime.mark((function e(t,r,n){var o,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.post("/groups/".concat(this.$route.params.id,"/memberships/").concat(r,"/verify"),{method:t});case 4:o=e.sent,data=o.data,this.team=data.updated,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:this.loading=!1;case 12:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(e,r,n){return t.apply(this,arguments)})}]),R}(v.b),x=R=w([Object(v.a)({middleware:"authenticated",layout:"teams"})],R),_=r(11),component=Object(_.a)(x,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",{staticClass:"is-size-4 mb-4"},[e._v("Team members")]),e._v(" "),r("b-table",{attrs:{loading:e.loading,data:e.members.data,"default-sort-direction":"asc","sort-icon":"arrow-up","sort-icon-size":"is-small"}},[r("b-table-column",{attrs:{sortable:"",field:"member",label:"Name"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(t.row.user.name)+"\n    ")]}}])}),e._v(" "),r("b-table-column",{attrs:{sortable:"",field:"role",label:"Role"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-select",{attrs:{value:t.row.role,disabled:t.row.userId===e.userId,loading:e.loadingId===t.row.id,placeholder:"Update role"},on:{input:function(r){return e.updateRole(t.row.id,r)}}},[r("option",{attrs:{value:"OWNER"}},[e._v("Owner")]),e._v(" "),r("option",{attrs:{value:"ADMIN"}},[e._v("Admin")]),e._v(" "),r("option",{attrs:{value:"MEMBER"}},[e._v("Member")])])]}}])}),e._v(" "),r("b-table-column",{attrs:{sortable:"",field:"createdAt",label:"Added"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n      "+e._s(new Date(t.row.createdAt).toLocaleDateString())+"\n    ")]}}])}),e._v(" "),r("b-table-column",{attrs:{"cell-class":"has-text-right"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("b-tooltip",{attrs:{label:"Remove"}},[r("b-button",{attrs:{type:"is-danger","icon-right":"delete",disabled:t.row.userId===e.userId},on:{click:function(r){return e.deleteMember(t.row.id,t.row.user.name)}}})],1)]}}])})],1),e._v(" "),r("div",{staticClass:"has-text-centered"},[e.members.hasMore?r("b-button",{attrs:{"icon-right":"arrow-down",loading:e.loading},on:{click:e.get}},[e._v("Load more members")]):e._e()],1),e._v(" "),r("h2",{staticClass:"is-size-5 mb-3 mt-5"},[e._v("Add member")]),e._v(" "),r("form",{on:{submit:function(t){return t.preventDefault(),e.add(t)}}},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column"},[r("b-field",{attrs:{label:"Name"}},[r("b-input",{attrs:{type:"text",required:""},model:{value:e.newMemberName,callback:function(t){e.newMemberName=t},expression:"newMemberName"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:"Email"}},[r("b-input",{attrs:{type:"email",required:""},model:{value:e.newMemberEmail,callback:function(t){e.newMemberEmail=t},expression:"newMemberEmail"}})],1)],1),e._v(" "),r("div",{staticClass:"column"},[r("b-field",{attrs:{label:"Role"}},[r("b-select",{attrs:{expanded:""},model:{value:e.newMemberRole,callback:function(t){e.newMemberRole=t},expression:"newMemberRole"}},[r("option",{attrs:{value:"ADMIN"}},[e._v("Admin")]),e._v(" "),r("option",{attrs:{value:"MEMBER"}},[e._v("Member")])])],1)],1)]),e._v(" "),r("b-button",{attrs:{type:"is-primary","native-type":"submit",loading:e.loadingAdd}},[e._v("Invite member")])],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);